<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="バウンティラッシュのかけら計算ツールで、目標達成日や必要なかけら数を計算できます。あなたのゲーム進行を手助け！">
    <meta name="keywords" content="バウンティラッシュ, かけら計算, ゲーム, 計算ツール">
    <meta name="author" content="ユーザー名">
    <meta property="og:title" content="バウンティラッシュかけら計算ツール">
    <meta property="og:description" content="バウンティラッシュのかけら計算ツールで、目標達成日や必要なかけら数を計算できます。">
    <meta property="og:image" content="サムネイル画像のURL">
    <meta property="og:url" content="ページのURL">
    <title>バウンティラッシュかけら計算</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f0f8ff;
            color: #333;
        }
        h1 {
            color: #4169e1;
            text-align: center;
        }
        input, select, button {
            margin-bottom: 10px;
            width: 100%;
            padding: 8px;
            border: 1px solid #4169e1;
            border-radius: 4px;
        }
        button {
            background-color: #4169e1;
            color: white;
            cursor: pointer;
        }
        button:hover {
            background-color: #1e90ff;
        }
        #result {
            margin-top: 20px;
            font-weight: bold;
            text-align: center;
            color: #4169e1;
            font-size: 1.2em;
            background-color: #e6f2ff;
            padding: 15px;
            border-radius: 4px;
        }
        #history {
            margin-top: 20px;
            padding: 10px;
            background-color: #e6f2ff;
            border-radius: 4px;
        }
        .history-item {
            background-color: #fff;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .history-item button {
            background-color: #ff6347;
            color: white;
            cursor: pointer;
            padding: 5px;
            border: none;
            border-radius: 4px;
        }
        .history-item button:hover {
            background-color: #ff4500;
        }
        .error {
            color: red;
            font-weight: bold;
        }
        #historyList {
            display: none;
        }
    </style>
</head>
<body>
    <h1>バウンティラッシュかけら計算</h1>
    
    <label for="startDate">開始日：</label>
    <input type="date" id="startDate"><br>

    <label for="targetShards">目標かけら数：</label>
    <input type="number" id="targetShards" min="1"><br>

    <label for="characterType">キャラクターの種類：</label>
    <select id="characterType">
        <option value="ultra">超フェス</option>
        <option value="limited">フェス限</option>
        <option value="regular">恒常</option>
    </select><br>

    <div id="limitedOptions" style="display:none;">
        <label for="purchaseRush">得ラッシュ30を購入しますか？</label>
        <select id="purchaseRush">
            <option value="yes">はい</option>
            <option value="no">いいえ</option>
        </select><br>
    </div>

    <label for="specialTraining">特訓をしますか？</label>
    <select id="specialTraining">
        <option value="yes">はい</option>
        <option value="no">いいえ</option>
    </select><br>

    <div id="trainingOptions" style="display:none;">
        <label for="allianceCheer">同盟エールが使えますか？</label>
        <select id="allianceCheer">
            <option value="yes">はい</option>
            <option value="no">いいえ</option>
        </select><br>

        <label for="paidTraining">特訓に課金しますか？</label>
        <select id="paidTraining">
            <option value="yes">はい</option>
            <option value="no">いいえ</option>
        </select><br>
    </div>

    <label for="leagueRewards">リーグ報酬のかけらを使いますか？</label>
    <select id="leagueRewards">
        <option value="yes">はい</option>
        <option value="no">いいえ</option>
    </select><br>

    <div id="leagueOptions" style="display:none;">
        <label for="leagueRank">シーズン最終日のランク：</label>
        <select id="leagueRank">
            <option value="SS">SS</option>
            <option value="S+">S+</option>
            <option value="S">S</option>
            <option value="S-">S-</option>
            <option value="A+">A+</option>
            <option value="A">A</option>
            <option value="A-">A-</option>
        </select><br>
    </div>

    <label for="challengeBattle">チャレバトでもらえるかけらを使いますか？</label>
    <select id="challengeBattle">
        <option value="yes">はい</option>
        <option value="no">いいえ</option>
    </select><br>

    <div id="challengeOptions" style="display:none;">
        <label for="paidChallenge">チャレバトに課金しますか？</label>
        <select id="paidChallenge">
            <option value="yes">はい</option>
            <option value="no">いいえ</option>
        </select><br>
    </div>

    <button onclick="calculateDate()">計算する</button>

    <div id="result"></div>

    <button onclick="toggleHistory()">履歴の表示/非表示</button>

    <div id="history">
        <h3>計算履歴</h3>
        <div id="historyList"></div>
    </div>

    <script>
        function showHideOptions() {
            document.getElementById('limitedOptions').style.display = 
                document.getElementById('characterType').value === 'limited' ? 'block' : 'none';
            document.getElementById('trainingOptions').style.display = 
                document.getElementById('specialTraining').value === 'yes' ? 'block' : 'none';
            document.getElementById('leagueOptions').style.display = 
                document.getElementById('leagueRewards').value === 'yes' ? 'block' : 'none';
            document.getElementById('challengeOptions').style.display = 
                document.getElementById('challengeBattle').value === 'yes' ? 'block' : 'none';
        }

        document.getElementById('characterType').addEventListener('change', showHideOptions);
        document.getElementById('specialTraining').addEventListener('change', showHideOptions);
        document.getElementById('leagueRewards').addEventListener('change', showHideOptions);
        document.getElementById('challengeBattle').addEventListener('change', showHideOptions);

        function calculateDate() {
            const startDate = new Date(document.getElementById('startDate').value);
            const targetShardsInput = document.getElementById('targetShards').value;
            const characterType = document.getElementById('characterType').value;
            const purchaseRush = document.getElementById('purchaseRush').value;
            const specialTraining = document.getElementById('specialTraining').value;
            const allianceCheer = document.getElementById('allianceCheer').value;
            const paidTraining = document.getElementById('paidTraining').value;
            const leagueRewards = document.getElementById('leagueRewards').value;
            const leagueRank = document.getElementById('leagueRank').value;
            const challengeBattle = document.getElementById('challengeBattle').value;
            const paidChallenge = document.getElementById('paidChallenge').value;

            // 入力チェック
            if (!/^\d+$/.test(targetShardsInput)) {
                document.getElementById('result').innerHTML = '<span class="error">半角数字で入力してください。</span>';
                return;
            }

            const targetShards = parseInt(targetShardsInput);

            let dailyShards = 0;
            let hasShardSource = false;

            // キャラクターの種類による基本かけら数
            if (characterType === 'regular') {
                dailyShards += 10;
                hasShardSource = true;
            } else if (characterType === 'limited' && purchaseRush === 'yes') {
                dailyShards += 6;
                hasShardSource = true;
            }

            // 特訓
            if (specialTraining === 'yes') {
                const hoursPerShard = paidTraining === 'yes' ? 3.75 : 5;
                dailyShards += 24 / hoursPerShard;
                hasShardSource = true;

                // 同盟エール
                if (allianceCheer === 'yes') {
                    dailyShards += 1;
                }
            }

            // チャレバト
            if (challengeBattle === 'yes') {
                dailyShards += paidChallenge === 'yes' ? 60 / 7 : 20 / 7;
                hasShardSource = true;
            }

            // リーグ報酬
            if (leagueRewards === 'yes') {
                hasShardSource = true;
            }

            // かけらを獲得する方法が選択されていない場合
            if (!hasShardSource && characterType !== 'regular') {
                document.getElementById('result').innerHTML = '<span class="error">エラー: かけらを獲得する方法が選択されていません。</span>';
                return;
            }

            // 目標達成日を計算
            const shardsRequired = targetShards - dailyShards;
            const daysRemaining = Math.ceil(shardsRequired / dailyShards);
            const targetDate = new Date(startDate);
            targetDate.setDate(targetDate.getDate() + daysRemaining);

            document.getElementById('result').innerHTML = '目標達成予定日: ' + targetDate.toLocaleDateString();

            // 履歴を更新
            const historyItem = document.createElement('div');
            historyItem.className = 'history-item';
            historyItem.innerHTML = `目標: ${targetShards} かけら, 開始日: ${startDate.toLocaleDateString()}, 計算結果: ${targetDate.toLocaleDateString()} <button onclick="removeHistory(this)">削除</button>`;
            document.getElementById('historyList').appendChild(historyItem);
        }

        function removeHistory(button) {
            button.parentElement.remove();
        }

        function toggleHistory() {
            const historyList = document.getElementById('historyList');
            historyList.style.display = historyList.style.display === 'none' ? 'block' : 'none';
        }

        showHideOptions();  // 初期設定で表示を調整
    </script>
</body>
</html>
